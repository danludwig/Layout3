var ViewModels;(function(n){(function(n){var t=function(){function n(){}return n}(),i;n.ActivitySearchInput=t,i=function(){function n(n){this.personId=n}return n.prototype.load=function(){var u=this,f=$.Deferred(),e=$.Deferred(),i,r,n;return $.get(App.Routes.WebApi.Activities.Locations.get()).done(function(n){e.resolve(n)}).fail(function(n,t,i){e.reject(n,t,i)}),i=$.Deferred(),$.get(App.Routes.WebApi.Employees.ModuleSettings.ActivityTypes.get()).done(function(n){i.resolve(n)}).fail(function(n,t,r){i.reject(n,t,r)}),r=$.Deferred(),n=new t,n.personId=this.personId,n.orderBy="",n.pageNumber=1,n.pageSize=2147483647,$.get(App.Routes.WebApi.Activities.get(),n).done(function(n){r.resolve(n)}).fail(function(n,t,i){r.reject(n,t,i)}),$.when(i,e,r).done(function(n,t,i){u.activityTypesList=n,u.activityLocationsList=t;var r=function(n){ko.mapping.fromJS(n,{},this),this.proxyImageSource=App.Routes.WebApi.Activities.Documents.Thumbnail.get(this.id(),n.id)},e={documents:{create:function(n){return new r(n.data)}},startsOn:{create:function(n){return n.data!=null?ko.observable(moment(n.data).toDate()):ko.observable()}},endsOn:{create:function(n){return n.data!=null?ko.observable(moment(n.data).toDate()):ko.observable()}}};ko.mapping.fromJS(i,e,u),f.resolve()}).fail(function(n,t,i){f.reject(n,t,i)}),f},n.prototype.deleteActivityById=function(n){$.ajax({async:!1,type:"DELETE",url:App.Routes.WebApi.Activities.del(n),success:function(){},error:function(n,t){alert(t)}})},n.prototype.deleteActivity=function(n,t,i){$("#confirmActivityDeleteDialog").dialog({dialogClass:"jquery-ui",width:"auto",resizable:!1,modal:!0,buttons:[{text:"Yes, confirm delete",click:function(){i.deleteActivityById(n.id()),$(this).dialog("close"),location.href=App.Routes.Mvc.My.Profile.get()}},{text:"No, cancel delete",click:function(){$(this).dialog("close")}},]})},n.prototype.editActivity=function(n,t,i){$.ajax({type:"GET",url:App.Routes.WebApi.Activities.getEditState(i),success:function(n){if(n.isInEdit)$("#activityBeingEditedDialog").dialog({dialogClass:"jquery-ui",width:"auto",resizable:!1,modal:!0,buttons:{Ok:function(){$(this).dialog("close");return}}});else{for(var i=t.target,r=null;i!=null&&i.nodeName!="TR";)i=i.parentElement;i!=null&&(r=i.attributes.href.value),r!=null&&(location.href=r)}},error:function(n,t,i){alert(t+"|"+i)}})},n.prototype.newActivity=function(){$.ajax({type:"POST",url:App.Routes.WebApi.Activities.post(),success:function(n){location.href=App.Routes.Mvc.My.Profile.activityEdit(n)},error:function(n,t,i){alert(t+"|"+i)}})},n.prototype.getTypeName=function(n){var i="",t;if(this.activityTypesList!=null){for(t=0;t<this.activityTypesList.length&&n!=this.activityTypesList[t].id;)t+=1;t<this.activityTypesList.length&&(i=this.activityTypesList[t].type)}return i},n.prototype.getLocationName=function(n){var i="",t;if(this.activityLocationsList!=null){for(t=0;t<this.activityLocationsList.length&&n!=this.activityLocationsList[t].id;)t+=1;t<this.activityLocationsList.length&&(i=this.activityLocationsList[t].officialName)}return i},n.prototype.activityDatesFormatted=function(n,t,i,r){var u="";return r=r!=null?r.toUpperCase():"MM/DD/YYYY",n==null?t!=null&&(u=moment(t).format(r)):(u=moment(n).format(r),i?u+=" -":t!=null&&(u+=" - "+moment(t).format(r))),u.length>0&&(u+="  "),u},n.prototype.activityTypesFormatted=function(n){for(var i="",r,t=0;t<this.activityTypesList.length;t+=1)for(r=0;r<n.length;r+=1)n[r].typeId()==this.activityTypesList[t].id&&(i.length>0&&(i+="; "),i+=this.activityTypesList[t].type);return i},n.prototype.activityLocationsFormatted=function(n){for(var i="",t=0;t<n.length;t+=1)t>0&&(i+=", "),i+=this.getLocationName(n[t].placeId());return i},n}(),n.ActivityList=i})(n.Activities||(n.Activities={}));var t=n.Activities})(ViewModels||(ViewModels={}))