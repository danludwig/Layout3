@using UCosmic.Web.Mvc.Models
@{
    ViewBag.Title = "Student Mobility Snapshot";
    var tenancy = Request.Tenancy();
    var styleDomain = tenancy != null ? tenancy.StyleDomain : "default";
    var tenantId = tenancy != null ? tenancy.TenantId : 0;
    var hasStyleDomain = !string.IsNullOrWhiteSpace(styleDomain) && !"default".Equals(styleDomain, StringComparison.OrdinalIgnoreCase);
    bool isLocal = HttpContext.Current.Request.IsLocal;
}
@section bib
{
    <nav class="bib" data-current-bib="map">
        @Html.Partial(MVC.Students.Views._Bib, new StudentsBibNavModel { })
    </nav>
}
@section styles
{
    <link rel="stylesheet" type="text/css" href="~/styles/sass/sheets/employees/summary.css" />
    @if (isLocal)
    {
        <link rel="stylesheet" type="text/css" href="/components_riot/app/styles/index.css" />
    }
@if (!isLocal)
{
    <link rel="stylesheet" type="text/css" href="https://ucosmic.firebaseapp.com/styles/index.css" />
}
}
<script>
    ttw.last_page = '';
    ttw.fire_ref = undefined;
    ttw.tags_loaded = [];
    ttw.user = {};
    ttw.pages = [];
    (function detectIE_mobile() {
        var ua = window.navigator.userAgent;
        var msie = ua.indexOf('MSIE ');
        var trident = ua.indexOf('Trident/');
        var edge = ua.indexOf('Edge/');
        if (msie > 0 || (trident > 0) || (edge > 0)) {
            ttw.is_ie = true;
        }
        ttw.is_mobile = typeof window.orientation !== 'undefined' ? true : false;
        //            ttw.is_mobile =  (/Mobi/.test(navigator.userAgent));
    })();
</script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
@if (isLocal)
{
    <script src="/components_riot/app/bower_components/riotcontrol/riotcontrol.js"></script>
    <script src="/components_riot/app/bower_components/kefir/dist/kefir.min.js"></script>
    @*<script src="/lib/cta.min.js"></script>*@

    <script src="/components_riot/app/components/utilities/closest.js"></script>
    <script src="/components_riot/app/components/utilities/equal.js"></script>
    <script src="/components_riot/app/components/utilities/add_style.js"></script>
    <script src="/components_riot/app/components/utilities/load_tag_3.js"></script>
    <script src="/components_riot/app/components/utilities/uniq_id.js"></script>
    <script src="/components_riot/app/components/utilities/tags_loaded.js"></script>

    <script src="/components_riot/app/components/stores/app_store.js"></script>
    <script src="/components_riot/app/components/is_loading/is_loading.js"></script>

    <script src="/components_riot/app/components/pages/students/map/student_map.js"></script>
    <script src="/components_riot/app/components/side_bar_filter/side_bar_filter.js"></script>
    <script src="/components_riot/app/components/form_elements/drop_down/drop_down.js"></script>
}
@if (!isLocal)
{
    <script src="https://ucosmic.firebaseapp.com/bower_components/riotcontrol/riotcontrol.js"></script>
    <script src="https://ucosmic.firebaseapp.com/bower_components/kefir/dist/kefir.min.js"></script>
    @*<script src="/lib/cta.min.js"></script>*@

    <script src="https://ucosmic.firebaseapp.com/components/utilities/closest.js"></script>
    <script src="https://ucosmic.firebaseapp.com/components/utilities/equal.js"></script>
    <script src="https://ucosmic.firebaseapp.com/components/utilities/add_style.js"></script>
    <script src="https://ucosmic.firebaseapp.com/components/utilities/load_tag_3.js"></script>
    <script src="https://ucosmic.firebaseapp.com/components/utilities/uniq_id.js"></script>
    <script src="https://ucosmic.firebaseapp.com/components/utilities/tags_loaded.js"></script>

    <script src="https://ucosmic.firebaseapp.com/components/stores/app_store.js"></script>
    <script src="https://ucosmic.firebaseapp.com/components/is_loading/is_loading.js"></script>

    <script src="https://ucosmic.firebaseapp.com/components/pages/students/map/student_map.js"></script>
    <script src="https://ucosmic.firebaseapp.com/components/side_bar_filter/side_bar_filter.js"></script>
    <script src="https://ucosmic.firebaseapp.com/components/form_elements/drop_down/drop_down.js"></script>
}
    @*<script src="https://ucosmic.firebaseapp.com/lib/pouchdb-5.2.1.min.js"></script>*@
    <div class="content fixed" data-current-module="students">
        <student_map id="page_student_table" style_domain="@styleDomain" tenant_id="@tenantId" firebase_token="@ViewBag.firebase_token"></student_map>
    </div>
    <script>
        var SharedMixin = {
            observable: riot.observable()
        };

        var app_store = new ttw.app_store()
        RiotControl.addStore(app_store)
        riot.mount('student_map') // Kickoff the Riot app.
    </script>
